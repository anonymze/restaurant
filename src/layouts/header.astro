---
import { cn } from "@/utils/libs/tailwaind";
import { VeganIcon } from "lucide-react";

const navigation = [
	{ name: "Présentation", href: "/presentation" },
	{ name: "Menu", href: "/menu" },
	{ name: "Événements", href: "/evenements" },
	{ name: "Contact", href: "/contact" },
];

const currentUrl = Astro.url.pathname;
console.log(currentUrl);
---

<header class="bg-white shadow-sm">
	<nav class="mx-auto flex max-w-7xl items-center justify-between p-6 md:px-8">
		<div class="flex md:flex-1">
			<a href="/" class="-m-1.5 p-1.5">
				<span class="sr-only">Votre Restaurant</span>
				<span class="flex items-center gap-2 text-2xl whitespace-nowrap font-serif text-stone-800"
					>Mauvaise Herbe <VeganIcon width={24} height={24} className="text-green-700 min-w-6" /></span
				>
			</a>
		</div>
		<div class="flex md:hidden">
			<button
				type="button"
				id="menu-open"
				class="-m-2.5 inline-flex items-center justify-center p-2.5 text-stone-700"
			>
				<span class="sr-only">Ouvrir le menu principal</span>
				<svg
					xmlns="http://www.w3.org/2000/svg"
					width="24"
					height="24"
					viewBox="0 0 24 24"
					fill="none"
					stroke="currentColor"
					stroke-width="2"
					stroke-linecap="round"
					stroke-linejoin="round"
					class="h-6 w-6"
					aria-hidden="true"
				>
					<line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line
						x1="4"
						x2="20"
						y1="18"
						y2="18"></line>
				</svg>
			</button>
		</div>
		<div class="hidden md:flex md:gap-x-6 lg:gap-x-12">
			{
				navigation.map((item) => (
					<a
						href={item.href}
						class={cn(
							"p-3 text-sm font-semibold leading-6 hover:text-primary transition-colors",
							currentUrl === item.href && " text-primary!"
						)}
					>
						{item.name}
					</a>
				))
			}
		</div>
		<div class="hidden md:flex md:flex-1 md:justify-end">
			<a
				href="/reservation"
				class="bg-green-700 px-3.5 py-2.5 text-sm font-semibold text-white shadow-sm hover:bg-green-700/90 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-b"
			>
				Réserver une table
			</a>
		</div>
	</nav>

	<!-- Mobile menu -->
	<div id="mobile-menu" class="hidden md:hidden" role="dialog" aria-modal="true">
		<div class="fixed inset-0 z-50"></div>
		<div
			class="fixed inset-y-0 right-0 z-50 w-full overflow-y-auto bg-white px-6 py-6 sm:max-w-sm sm:ring-1 sm:ring-gray-900/10"
		>
			<div class="flex items-center justify-between">
				<a href="/" class="-m-1.5 p-1.5">
					<span class="sr-only">Votre Restaurant</span>
					<span class="flex items-center gap-2 text-xl font-serif whitespace-nowrap text-stone-800"
						>Mauvaise herbe <VeganIcon width={20} height={20} className="text-green-700 min-w-6" /></span
					>
				</a>
				<button type="button" id="menu-close" class="-m-2.5 p-2.5 text-stone-700">
					<span class="sr-only">Fermer le menu</span>
					<svg
						xmlns="http://www.w3.org/2000/svg"
						width="24"
						height="24"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="2"
						stroke-linecap="round"
						stroke-linejoin="round"
						class="h-6 w-6"
						aria-hidden="true"
					>
						<path d="M18 6 6 18"></path><path d="m6 6 12 12"></path>
					</svg>
				</button>
			</div>
			<div class="mt-6 flow-root">
				<div class="-my-6 divide-y divide-gray-500/10">
					<div class="flex flex-col space-y-4 py-5">
						{
							navigation.map((item) => (
								<a
									href={item.href}
									class="-mx-3 block  px-3 py-4 text-base font-semibold leading-7 text-stone-900 hover:bg-gray-50"
								>
									{item.name}
								</a>
							))
						}
					</div>
					<div class="py-6">
						<a
							href="/reservation"
							class="-mx-3 block px-3 py-2.5 text-base font-semibold leading-7 text-white bg-green-700 hover:bg-green-700/90"
						>
							Réserver une table
						</a>
					</div>
				</div>
			</div>
		</div>
	</div>
</header>

<!-- prevent processing -->
<script type="module" define:vars={{ currentUrl }}>
	const menuOpenBtn = document.getElementById("menu-open");
	const menuCloseBtn = document.getElementById("menu-close");
	const mobileMenu = document.getElementById("mobile-menu");

	menuOpenBtn?.addEventListener("click", () => {
		mobileMenu?.classList.remove("hidden");
	});

	menuCloseBtn?.addEventListener("click", () => {
		mobileMenu?.classList.add("hidden");
	});
</script>

---
import { Image } from "astro:assets";
import Layout from "@/layouts/layout.astro";
import EspaceImg from "@/assets/images/espace.webp";
import PlatImg from "@/assets/images/plat.webp";
import AnimatedLink from "@/components/animated-link";
import { getImage } from "astro:assets";
import { cn } from "@/utils/libs/tailwind";
import AnimatedText from "@/components/animated-text";
import LogoSmall from "@/assets/images/logo_small.webp";
import FlagEN from "@/assets/icons/flag-en.svg";
import FlagFR from "@/assets/icons/flag-fr.svg";

const optimizedPlanteImage = await getImage({
	src: EspaceImg,
	format: "webp",
	widths: [240, 540, 720, 980, EspaceImg.width],
	loading: "eager",
});

const optimizedPlatImage = await getImage({
	src: PlatImg,
	format: "webp",
	widths: [240, 540, 720, 980, PlatImg.width],
	loading: "eager",
});
---

<Layout overflow={false} header={false} footer={false}>
	<Fragment slot="head-preload">
		<link
			rel="preload"
			href={optimizedPlanteImage.src}
			as="image"
			imagesrcset={optimizedPlanteImage.srcSet.attribute}
			imagesizes={`(max-width: 360px) 240px, (max-width: 720px) 540px, (max-width: 980px) 720px, (max-width: 1600px) 980px, ${EspaceImg.width}px`}
		/>
		<link
			rel="preload"
			href={optimizedPlatImage.src}
			as="image"
			imagesrcset={optimizedPlatImage.srcSet.attribute}
			imagesizes={`(max-width: 360px) 240px, (max-width: 720px) 540px, (max-width: 980px) 720px, (max-width: 1600px) 980px, ${PlatImg.width}px`}
		/>
	</Fragment>

	<main class="flex flex-col w-full h-full lg:flex-row">
		<h1 class="sr-only">Mauvaise herbe restaurant</h1>
		<div class="relative flex-1 h-1/2 lg:h-full">
			<AnimatedText
				client:load
				className="absolute bottom-0 left-1/2 -translate-x-1/2 z-10 h-fit text-6xl text-primary uppercase font-bold text-shadow lg:top-16 lg:right-3 lg:left-auto lg:translate-x-0 lg:text-8xl"
			>
				Mauvaise
			</AnimatedText>

			<Image
				src={optimizedPlanteImage.src}
				width={EspaceImg.width}
				height={EspaceImg.height}
				sizes={`(max-width: 360px) 240px, (max-width: 720px) 540px, (max-width: 980px) 720px, (max-width: 1600px) 980px, ${EspaceImg.width}px`}
				alt="Un plat du restaurant"
				class="w-full h-full object-cover"
				loading="eager"
				fetchpriority="high"
			/>

			<div class="absolute inset-0 z-10 m-auto text-center w-fit h-fit">
				<h2
					class="mb-3 p-1 pb-2 text-4xl text-white text-shadow backdrop-blur-xs uppercase font-serif lg:text-5xl"
				>
					Notre restaurant
				</h2>

				<AnimatedLink
					client:load
					title="Redirection à la page de la carte du restaurant"
					href="/concept"
					className="bg-primary/90"
				>
					Voir la présentation de notre restaurant
				</AnimatedLink>
			</div>

			<div
				class={cn(
					"absolute inset-0",
					"bg-gradient-to-t from-white/10 to-transparent",
					"after:block after:w-full after:h-full after:bg-gradient-to-t after:from-white/50 after:to-transparent after:opacity-0 after:transition-opacity after:duration-600"
				)}
			>
			</div>
		</div>

		<div class="relative flex-1 h-1/2 group lg:h-full">
			<div
				class="absolute top-0 left-1/2 -translate-x-1/2 z-10 flex items-end gap-2 h-fit text-6xl text-green-700 text-dark text-shadow font-bold uppercase lg:text-8xl lg:top-16 lg:pt-8 lg:left-3 lg:translate-x-0"
			>
				<AnimatedText client:load delay={0.3}>Herbe</AnimatedText>

				<AnimatedText client:load delay={0.6}>
					<Image src={LogoSmall} alt="Logo du restaurant" class="w-auto h-12 ml-2 mb-1 lg:h-18 lg:mb-2"  />
				</AnimatedText>
			</div>

			<Image
				src={optimizedPlatImage.src}
				width={PlatImg.width}
				height={PlatImg.height}
				sizes={`(max-width: 360px) 240px, (max-width: 720px) 540px, (max-width: 980px) 720px, (max-width: 1600px) 980px, ${PlatImg.width}px`}
				alt="Un plat du restaurant"
				class="w-full h-full object-cover"
				loading="eager"
				fetchpriority="high"
			/>

			<div class="absolute inset-0 z-10 m-auto text-center w-fit h-fit">
				<h2
					class="mb-3 p-1 pb-2 text-4xl text-white text-shadow backdrop-blur-xs uppercase font-serif lg:text-5xl"
				>
					Réservation
				</h2>

				<a href="/reservation">
					<FlagEN class="w-9 h-9" />
				</a>
			</div>
			<div
				class={cn(
					"absolute inset-0",
					"bg-gradient-to-t from-white/10 to-transparent",
					"after:block after:w-full after:h-full after:bg-gradient-to-t after:from-white/50 after:to-transparent after:opacity-0 after:transition-opacity after:duration-600"
				)}
			>
			</div>
		</div>
	</main>
</Layout>
